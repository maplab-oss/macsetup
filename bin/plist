#!/bin/bash

# Load output helpers (optional, fallback to inline if unavailable)
source <(curl -fsSL https://raw.githubusercontent.com/felixsebastian/macsetup/main/lib/output.sh) 2>/dev/null || true

# List all projects in $HOME/Code excluding archived ones
CODE_DIR="$HOME/Code"

if type log >/dev/null 2>&1; then
    log "Projects in $CODE_DIR:"
else
    echo "ðŸ”§ Projects in $CODE_DIR:"
fi
echo "====================="

# Check if Code directory exists
if [ ! -d "$CODE_DIR" ]; then
    if type error >/dev/null 2>&1; then
        error "Directory $CODE_DIR does not exist."
    else
        echo "ðŸ”§ âœ— Directory $CODE_DIR does not exist."
    fi
    exit 1
fi

# Count and list directories, excluding _archive
count=0
for dir in "$CODE_DIR"/*; do
    if [ -d "$dir" ] && [ "$(basename "$dir")" != "_archive" ] && [ "$(basename "$dir")" != "archive" ]; then
        basename "$dir"
        ((count++))
    fi
done | sort

echo "====================="
echo "Total: $count projects" 