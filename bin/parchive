#!/bin/bash

# Load output helpers (optional, fallback to inline if unavailable)
source <(curl -fsSL https://raw.githubusercontent.com/felixsebastian/macsetup/main/lib/output.sh) 2>/dev/null || true

# Create archive directory if it doesn't exist
ARCHIVE_DIR="$HOME/Code/_archive"
mkdir -p "$ARCHIVE_DIR"

# Check if any arguments were provided
if [ $# -eq 0 ]; then
    echo "Usage: parchive <folder1> [folder2] [folder3] ..."
    echo "Moves folders from $HOME/Code to $HOME/Code/_archive"
    exit 1
fi

# Process each argument
for folder in "$@"; do
    SOURCE_PATH="$HOME/Code/$folder"
    DEST_PATH="$ARCHIVE_DIR/$folder"
    
    if [ -d "$SOURCE_PATH" ]; then
        if type log >/dev/null 2>&1; then
            log "Moving $folder to archive."
        else
            echo "ðŸ”§ Moving $folder to archive."
        fi
        mv "$SOURCE_PATH" "$DEST_PATH"
        if type success >/dev/null 2>&1; then
            success "Moved $folder."
        else
            echo "ðŸ”§ âœ“ Moved $folder."
        fi
    else
        if type error >/dev/null 2>&1; then
            error "Folder '$folder' not found in $HOME/Code."
        else
            echo "ðŸ”§ âœ— Folder '$folder' not found in $HOME/Code."
        fi
    fi
done

if type success >/dev/null 2>&1; then
    success "Archive operation complete."
else
    echo "ðŸ”§ âœ“ Archive operation complete."
fi
